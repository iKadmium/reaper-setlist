import{b as B,a as p,d as _e,f as S,g as Bt,s as f,t as he}from"../chunks/CS4_VdcA.js";import{o as fe,a as $e}from"../chunks/DUA-E5SE.js";import{p as qe,q as P,k as Dt,s as o,f as N,a as ye,c as s,o as b,l as t,m as u,r,t as ot,n as xe,a6 as Ct}from"../chunks/Sw90J2G4.js";import{r as D,i as L}from"../chunks/Czi9triy.js";import{a as C,g as ke,B as M,j,n as H,e as we,f as Te}from"../chunks/R0BlLbBX.js";import{P as be}from"../chunks/CATmRVNY.js";const vt=0,it=1,Et=2,Se=5;var Pe=B('<svg><path fill="currentColor" d="M14 19h4V5h-4M6 19h4V5H6z"></path></svg>');function Me(m,g){const v=D(g,["$$slots","$$events","$$legacy"]);var a=Pe();C(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),p(m,a)}var Ae=B('<svg><path fill="currentColor" d="M19 12c0 3.86-3.14 7-7 7s-7-3.14-7-7s3.14-7 7-7s7 3.14 7 7"></path></svg>');function Fe(m,g){const v=D(g,["$$slots","$$events","$$legacy"]);var a=Ae();C(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),p(m,a)}var Le=B('<svg><path fill="currentColor" d="M16 18h2V6h-2M6 18l8.5-6L6 6z"></path></svg>');function Be(m,g){const v=D(g,["$$slots","$$events","$$legacy"]);var a=Le();C(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),p(m,a)}var De=B('<svg><path fill="currentColor" d="M6 18V6h2v12zm3.5-6L18 6v12z"></path></svg>');function Ce(m,g){const v=D(g,["$$slots","$$events","$$legacy"]);var a=De();C(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),p(m,a)}var Ee=B('<svg><path fill="currentColor" d="M18 18H6V6h12z"></path></svg>');function ze(m,g){const v=D(g,["$$slots","$$events","$$legacy"]);var a=Ee();C(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),p(m,a)}var Ie=S('<div class="next-song svelte-tcdq5v"><div class="next-song-name svelte-tcdq5v"> </div> <div class="next-song-duration svelte-tcdq5v"> </div></div>'),Re=S('<div class="set-complete svelte-tcdq5v">Set Complete!</div>'),Ve=(m,g,v)=>g(t(v)),Ye=S('<button class="marker-button svelte-tcdq5v"><div class="marker-name svelte-tcdq5v"> </div> <div class="marker-time svelte-tcdq5v"> </div></button>'),Ne=S('<div class="markers-section svelte-tcdq5v"><h3 class="svelte-tcdq5v">Song Markers</h3> <div class="markers-grid svelte-tcdq5v"></div></div>'),je=S('<div class="current-song-section svelte-tcdq5v"><div class="song-info svelte-tcdq5v"><div class="song-meta svelte-tcdq5v"><span class="song-number"> </span></div> <h2 class="song-title svelte-tcdq5v"> </h2></div> <div class="track-navigation svelte-tcdq5v"><!> <!></div> <div class="next-up-info svelte-tcdq5v"><div class="next-up-header svelte-tcdq5v"><h4 class="svelte-tcdq5v">Next Up</h4> <!></div></div></div> <div class="transport-section svelte-tcdq5v"><div class="transport-controls svelte-tcdq5v"><div class="main-controls svelte-tcdq5v"><!> <!> <!></div></div> <div class="song-progress"><div class="progress-group svelte-tcdq5v"><div class="progress-label svelte-tcdq5v"><span>Song Progress</span> <span class="time-display svelte-tcdq5v"> </span></div> <div class="progress-bar-container svelte-tcdq5v"><div class="progress-bar svelte-tcdq5v"><div class="progress-fill svelte-tcdq5v"></div> <div class="progress-handle svelte-tcdq5v"></div></div></div> <div class="remaining-time svelte-tcdq5v"> </div></div></div></div> <div class="set-section svelte-tcdq5v"><div class="set-progress"><div class="progress-group svelte-tcdq5v"><div class="progress-label svelte-tcdq5v"><span>Set Progress</span> <span class="time-display svelte-tcdq5v"> </span></div> <div class="progress-bar-container svelte-tcdq5v"><div class="progress-bar set-progress-bar svelte-tcdq5v"><div class="progress-fill svelte-tcdq5v"></div> <div class="progress-handle svelte-tcdq5v"></div></div></div> <div class="remaining-time svelte-tcdq5v"> </div></div></div></div> <!>',1),He=S('<div class="no-setlist svelte-tcdq5v"><h2 class="svelte-tcdq5v">No Setlist Loaded</h2> <p class="svelte-tcdq5v">Please load a setlist to begin playing.</p> <!></div>'),Oe=S('<meta:head><title>Player - Reaper Setlist</title></meta:head> <div class="player-container svelte-tcdq5v"><h1>Live Player</h1> <!></div>',1);function Xe(m,g){qe(g,!0);const v=ke();let a=P(null),c=P(0),$=P(Dt(vt)),w=P(0),nt=u(()=>t(a)?t(a).slice(0,t(c)).reduce((e,n)=>e+(n.length||0),0)+t(w):0),O=P(null);const U=u(()=>!t(a)||t(c)<0||t(c)>=t(a).length?null:t(a)[t(c)]||null);let G=P(Dt([]));const E=u(()=>{var e;return((e=t(U))==null?void 0:e.length)||0}),zt=u(()=>Math.max(0,t(E)-t(w))),J=u(()=>t(a)?t(a).reduce((e,n)=>e+(n.length||0),0):0),It=u(()=>t(a)?(()=>{let e=0;for(let n=t(c);n<t(a).length;n++){const k=t(a)[n].length||0;n===t(c)?e+=Math.max(0,k-t(w)):e+=k}return e})():0),lt=u(()=>t(E)===0?0:Math.min(100,t(w)/t(E)*100)),ct=u(()=>t(J)===0?0:Math.min(100,t(nt)/t(J)*100));function T(e){const n=Math.floor(e/60),x=Math.floor(e%60);return`${n}:${x.toString().padStart(2,"0")}`}function dt(e){return e.replace(/\.[^/.]+$/,"")}async function Rt(){try{if(t($)===it){const e=await v.reaper.pause();A(e)}else if(t($)===Et||t($)===vt){const e=await v.reaper.play();A(e)}}catch(e){H.error(`Failed to toggle playback: ${e.message}`)}}async function Vt(){try{await v.reaper.stop(),await z()}catch(e){H.error(`Failed to stop playback: ${e.message}`)}}async function Yt(){if(t(c)>0){Ct(c,-1);const e=await v.reaper.previousTab();K(e.markers),A(e.transport)}}async function Nt(){if(t(a)&&t(c)<t(a).length-1){Ct(c);const e=await v.reaper.nextTab();K(e.markers),A(e.transport)}}async function jt(e){try{await v.reaper.goToMarker(e.id),await z()}catch(n){H.error(`Failed to jump to marker: ${n.message}`),console.error("Failed to jump to marker:",n)}}async function Ht(){try{await v.reaper.record(),await z()}catch(e){H.error(`Failed to toggle recording: ${e.message}`),console.error("Failed to toggle recording:",e)}}function A(e){e?(b($,e.playState,!0),b(w,e.positionSeconds,!0)):(b($,vt,!0),b(w,0))}function K(e){b(G,e,!0)}async function z(){try{const e=await v.reaper.getTransport();A(e)}catch(e){console.error("Failed to update transport:",e)}}async function Ot(){try{const e=await v.reaper.getMarkers();K(e)}catch(e){console.error("Failed to load markers:",e)}}fe(async()=>{try{b(a,await v.script.getOpenTabs(),!0),b(O,window.setInterval(z,1e3),!0),await Ot()}catch(e){console.error(`Failed to load data: ${e.message}`)}}),$e(()=>{t(O)&&window.clearInterval(t(O))});var pt=Oe(),gt=o(N(pt),2),Ut=o(s(gt),2);{var Gt=e=>{var n=je(),x=N(n),k=s(x),I=s(k),R=s(I),Kt=s(R);r(R),r(I);var ut=o(I,2),Qt=s(ut,!0);r(ut),r(k);var Q=o(k,2),mt=s(Q);const Wt=u(()=>t(c)===0);M(mt,{variant:"icon",onclick:Yt,get disabled(){return t(Wt)},children:(i,d)=>{Ce(i,{})},$$slots:{default:!0}});var Xt=o(mt,2);const Zt=u(()=>!t(a)||t(c)>=t(a).length-1);M(Xt,{variant:"icon",onclick:Nt,get disabled(){return t(Zt)},children:(i,d)=>{Be(i,{})},$$slots:{default:!0}}),r(Q);var _t=o(Q,2),ht=s(_t),te=o(s(ht),2);{var ee=i=>{var d=Bt();const h=u(()=>t(a)[t(c)+1]);var q=N(d);{var y=_=>{var l=Ie(),F=s(l),V=s(F,!0);r(F);var Y=o(F,2),at=s(Y,!0);r(Y),r(l),ot((ue,me)=>{f(V,ue),f(at,me)},[()=>dt(t(h).name),()=>Te(t(h).length)]),p(_,l)};L(q,_=>{t(h)&&_(y)})}p(i,d)},re=i=>{var d=Re();p(i,d)};L(te,i=>{t(c)<t(a).length-1?i(ee):i(re,!1)})}r(ht),r(_t),r(x);var W=o(x,2),X=s(W),ft=s(X),$t=s(ft);const se=u(()=>t($)===it||t($)===Et?"delete":"primary");M($t,{variant:"icon",onclick:Vt,get color(){return t(se)},children:(i,d)=>{ze(i,{})},$$slots:{default:!0}});var qt=o($t,2);M(qt,{variant:"icon",onclick:Rt,color:"success",children:(i,d)=>{var h=Bt(),q=N(h);{var y=l=>{Me(l,{})},_=l=>{be(l,{})};L(q,l=>{t($)===it?l(y):l(_,!1)})}p(i,h)},$$slots:{default:!0}});var ae=o(qt,2);const oe=u(()=>t($)===Se?"delete":"primary");M(ae,{variant:"icon",onclick:Ht,get color(){return t(oe)},children:(i,d)=>{Fe(i,{})},$$slots:{default:!0}}),r(ft),r(X);var yt=o(X,2),xt=s(yt),Z=s(xt),kt=o(s(Z),2),ve=s(kt);r(kt),r(Z);var tt=o(Z,2),wt=s(tt),Tt=s(wt),ie=o(Tt,2);r(wt),r(tt);var bt=o(tt,2),ne=s(bt);r(bt),r(xt),r(yt),r(W);var et=o(W,2),St=s(et),Pt=s(St),rt=s(Pt),Mt=o(s(rt),2),le=s(Mt);r(Mt),r(rt);var st=o(rt,2),At=s(st),Ft=s(At),ce=o(Ft,2);r(At),r(st);var Lt=o(st,2),de=s(Lt);r(Lt),r(Pt),r(St),r(et);var pe=o(et,2);{var ge=i=>{var d=Ne(),h=o(s(d),2);we(h,21,()=>t(G),q=>q.id,(q,y)=>{var _=Ye();_.__click=[Ve,jt,y];var l=s(_),F=s(l,!0);r(l);var V=o(l,2),Y=s(V,!0);r(V),r(_),ot(at=>{f(F,t(y).name),f(Y,at)},[()=>T(t(y).position)]),p(q,_)}),r(h),r(d),p(i,d)};L(pe,i=>{t(G).length>0&&i(ge)})}ot((i,d,h,q,y,_,l)=>{f(Kt,`Track ${t(c)+1} of ${t(a).length??""}`),f(Qt,i),f(ve,`${d??""} / ${h??""}`),j(Tt,`width: ${t(lt)??""}%`),j(ie,`left: ${t(lt)??""}%`),f(ne,`-${q??""}`),f(le,`${y??""} / ${_??""}`),j(Ft,`width: ${t(ct)??""}%`),j(ce,`left: ${t(ct)??""}%`),f(de,`-${l??""}`)},[()=>dt(t(U).name),()=>T(t(w)),()=>T(t(E)),()=>T(t(zt)),()=>T(t(nt)),()=>T(t(J)),()=>T(t(It))]),p(e,n)},Jt=e=>{var n=He(),x=o(s(n),4);M(x,{elementType:"a",href:"#/",color:"primary",children:(k,I)=>{xe();var R=he("Browse Setlists");p(k,R)},$$slots:{default:!0}}),r(n),p(e,n)};L(Ut,e=>{t(a)&&t(U)?e(Gt):e(Jt,!1)})}r(gt),p(m,pt),ye()}_e(["click"]);export{Xe as component};
