import{g as M,B as h,f as Y,n as p}from"../chunks/DHXfWtOE.js";import{f,a as l,s as S,t as T}from"../chunks/BzJ4SX3Z.js";import{p as Z,k as C,s as y,f as O,a as ee,c as _,r as j,t as B,x as E,l as $,m as w,n as I}from"../chunks/CK57Ve49.js";import{i as L}from"../chunks/_0x7LJxc.js";import{I as te,R as oe,P as re}from"../chunks/BuXuVklD.js";import{D as se}from"../chunks/BOcwaSDJ.js";import{P as ae}from"../chunks/D__l0Aao.js";const ne=async({fetch:P})=>{try{const r=M(P),[u,n]=await Promise.all([r.songs.list(),r.script.listProjects()]);return{songs:u,projects:n}}catch(r){return{songs:{},error:r instanceof Error?r.message:"An unknown error occurred."}}},je=Object.freeze(Object.defineProperty({__proto__:null,load:ne},Symbol.toStringTag,{value:"Module"}));var ce=f('<p style="color: red;"> </p>'),ie=f('<div class="song-info svelte-sjawj0"><span class="song-name svelte-sjawj0"> </span> <span class="song-duration svelte-sjawj0"> </span></div>'),le=f("<!> <!>",1),de=f('<div class="action-section"><!> <!></div>'),pe=f('<p style="color: var(--text-muted);">No Reaper projects found. Please double-check your backing tracks folder in Settings.</p>'),ue=f("<meta:head><title>Songs - Reaper Setlist</title></meta:head> <h1>Songs</h1> <!> <!>",1);function $e(P,r){Z(r,!0);let u=C(r.data.songs),n=C(r.data.projects),k=w(()=>n?n.filter(e=>!Object.values(u).some(t=>t.path===e)):[]);const a=M(),R=r.data.error;async function N(e){try{await a.reaper.newTab(),await a.script.openProject(e.path),p.success(`${e.name} loaded successfully in Reaper!`)}catch(t){console.error("Error loading song in Reaper:",t),p.error("Failed to communicate with Reaper")}}async function z(e){if(confirm("Are you sure you want to delete this song?"))try{await a.songs.delete(e.id),delete u[e.id],a.sets.deleteSongFromSets(e.id),p.success("Song deleted successfully")}catch(t){p.error(`Failed to delete song: ${t.message}`);return}}async function G(e){var c;const t=(c=e.split("/").pop())==null?void 0:c.replace(/\.[^/.]+$/,"");await a.reaper.newTab(),await a.script.openProject(e);const o=await a.script.getProjectLength();return await a.reaper.closeTab(),await a.songs.add({name:t||e,path:e,length:o})}async function q(){if(!n||n.length===0){p.error("No Reaper projects found to add.");return}const e=[];for(const t of $(k))try{const o=await G(t);u[o.id]=o,e.push(o.name)}catch(o){console.error(`Failed to add song from project ${t}:`,o),p.error(`Failed to add song from project ${t}`)}e.length>0&&p.success(`Added songs: ${e.join(", ")}`)}function H(e,t){return e.name.localeCompare(t.name)}var D=ue(),F=y(O(D),4);{var J=e=>{var t=ce(),o=_(t,!0);j(t),B(()=>S(o,R)),l(e,t)},K=e=>{const t=w(()=>Object.values(u).toSorted(H));te(e,{get items(){return $(t)},nameDisplay:(c,s=E)=>{var m=ie(),i=_(m),g=_(i,!0);j(i);var d=y(i,2),v=_(d,!0);j(d),j(m),B(x=>{S(g,s().name),S(v,x)},[()=>Y(s().length)]),l(c,m)},actions:(c,s=E)=>{oe(c,{primaryAction:g=>{h(g,{color:"primary",onclick:()=>N(s()),variant:"icon",children:(d,v)=>{ae(d,{})},$$slots:{default:!0}})},secondaryActions:g=>{var d=le(),v=O(d);const x=w(()=>`#/song/${s().id}/edit`);h(v,{elementType:"a",color:"edit",get href(){return $(x)},variant:"icon",children:(b,X)=>{re(b,{})},$$slots:{default:!0}});var W=y(v,2);h(W,{color:"delete",onclick:()=>z(s()),variant:"icon",children:(b,X)=>{se(b,{})},$$slots:{default:!0}}),l(g,d)},$$slots:{primaryAction:!0,secondaryActions:!0}})},$$slots:{nameDisplay:!0,actions:!0}})};L(F,e=>{R?e(J):e(K,!1)})}var Q=y(F,2);{var U=e=>{var t=de(),o=_(t);h(o,{elementType:"a",href:"#/song/add",color:"success",children:(s,m)=>{I();var i=T("Add Song");l(s,i)},$$slots:{default:!0}});var A=y(o,2);const c=w(()=>$(k).length===0);h(A,{elementType:"button",get disabled(){return $(c)},onclick:q,color:"success",children:(s,m)=>{I();var i=T("Add All");l(s,i)},$$slots:{default:!0}}),j(t),l(e,t)},V=e=>{var t=pe();l(e,t)};L(Q,e=>{n&&n.length>0?e(U):e(V,!1)})}l(P,D),ee()}export{$e as component,je as universal};
