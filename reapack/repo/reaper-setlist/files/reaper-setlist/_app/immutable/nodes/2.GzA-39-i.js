import{g as z,a as W,n as x,B as D,f as X}from"../chunks/_ZxBKxY3.js";import{b as Z,a as i,f as _,s as w,t as ee}from"../chunks/Du2ossJl.js";import{o as te}from"../chunks/BdtkCd8H.js";import{p as se,k as ae,s as f,f as B,a as re,c as o,r as n,t as H,x as R,l as T,m as j,n as oe}from"../chunks/Cl0Xhb8i.js";import{r as ne,i as V}from"../chunks/D9aH2qsm.js";import{I as ie,R as le,P as ce}from"../chunks/CJ-BsevV.js";import{D as de}from"../chunks/B0UuToe8.js";import{P as ue}from"../chunks/BBpWFnfa.js";const ve=async({fetch:h})=>{try{const a=z(h),[l,c]=await Promise.all([a.sets.list(),a.songs.list()]);return{sets:l,songs:c}}catch(a){return console.error("Error loading sets and songs:",a),{sets:{},songs:{},error:a instanceof Error?a.message:"An unknown error occurred."}}},Ce=Object.freeze(Object.defineProperty({__proto__:null,load:ve},Symbol.toStringTag,{value:"Module"}));var pe=Z('<svg><path fill="currentColor" d="M19 21H8V7h11m0-2H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2m-3-4H4a2 2 0 0 0-2 2v14h2V3h12z"></path></svg>');function fe(h,a){const l=ne(a,["$$slots","$$events","$$legacy"]);var c=pe();W(c,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...l})),i(h,c)}var ge=_('<p style="color: red;"> </p>'),me=_('<div class="set-info svelte-1sbbukk"><div class="set-header svelte-1sbbukk"><span class="date svelte-1sbbukk"> </span> <span class="venue svelte-1sbbukk"> </span></div> <div class="set-details svelte-1sbbukk"><span class="song-count svelte-1sbbukk"> </span> <span class="duration svelte-1sbbukk"> </span></div></div>'),_e=_("<!> <!> <!>",1),he=_('<div class="action-section"><!></div>'),ye=_('<p style="color: var(--text-muted);">No songs available. Please add some songs to get started.</p>'),$e=_("<meta:head><title>Sets - Reaper Setlist</title></meta:head> <h1>Sets</h1> <!> <!>",1);function Fe(h,a){se(a,!0);const l=ae(a.data.sets),c=a.data.songs,P=a.data.error,M=z();te(()=>{P&&x.error(`Failed to load data: ${P}`)});async function E(e){if(confirm("Are you sure you want to delete this set?"))try{await M.sets.delete(e.id),delete l[e.id],x.success("Set deleted successfully")}catch(t){x.error(`Failed to delete set: ${t.message}`)}}async function I(e){const t={...e,id:void 0,venue:`${e.venue} (copy)`};try{const r=await M.sets.add(t);l[r.id]=r,x.success("Set duplicated successfully")}catch(r){x.error(`Failed to duplicate set: ${r.message}`)}}function L(e,t){return e.date!==t.date?new Date(e.date).getTime()-new Date(t.date).getTime():e.venue!==t.venue?e.venue.localeCompare(t.venue):e.id.localeCompare(t.id)}function G(e){const t=new Date(e),r=new Date().getFullYear(),S=t.getFullYear(),d={day:"numeric",month:"long"};S!==r&&(d.year="numeric");const s=navigator.language||"en-US";return t.toLocaleDateString(s,d)}var O=$e(),Y=f(B(O),4);{var N=e=>{var t=ge(),r=o(t,!0);n(t),H(()=>w(r,P)),i(e,t)},U=e=>{const t=j(()=>Object.values(l).toSorted(L));ie(e,{get items(){return T(t)},nameDisplay:(d,s=R)=>{var A=me(),C=o(A),u=o(C),g=o(u,!0);n(u);var v=f(u,2),F=o(v,!0);n(v),n(C);var y=f(C,2),$=o(y),p=o($);n($);var k=f($,2),Q=o(k,!0);n(k),n(y),n(A),H((b,m)=>{w(g,b),w(F,s().venue),w(p,`${s().songs.length??""} song${s().songs.length>1?"s":""}`),w(Q,m)},[()=>G(s().date),()=>X(s().songs.map(b=>{var m;return((m=c[b])==null?void 0:m.length)||0}).reduce((b,m)=>b+m,0))]),i(d,A)},actions:(d,s=R)=>{le(d,{primaryAction:u=>{const g=j(()=>`#/set/${s().id}/load`);D(u,{color:"primary",elementType:"a",get href(){return T(g)},variant:"icon",children:(v,F)=>{ue(v,{})},$$slots:{default:!0}})},secondaryActions:u=>{var g=_e(),v=B(g);const F=j(()=>`#/set/${s().id}/edit`);D(v,{elementType:"a",color:"edit",get href(){return T(F)},variant:"icon",children:(p,k)=>{ce(p,{})},$$slots:{default:!0}});var y=f(v,2);D(y,{color:"delete",onclick:()=>E(s()),variant:"icon",children:(p,k)=>{de(p,{})},$$slots:{default:!0}});var $=f(y,2);D($,{color:"success",onclick:()=>I(s()),variant:"icon",children:(p,k)=>{fe(p,{})},$$slots:{default:!0}}),i(u,g)},$$slots:{primaryAction:!0,secondaryActions:!0}})},$$slots:{nameDisplay:!0,actions:!0}})};V(Y,e=>{P?e(N):e(U,!1)})}var q=f(Y,2);{var J=e=>{var t=he(),r=o(t);D(r,{elementType:"a",href:"#/set/add",color:"success",children:(S,d)=>{oe();var s=ee("Add Set");i(S,s)},$$slots:{default:!0}}),n(t),i(e,t)},K=e=>{var t=ye();i(e,t)};V(q,e=>{Object.entries(c).length>0?e(J):e(K,!1)})}i(h,O),re()}export{Fe as component,Ce as universal};
