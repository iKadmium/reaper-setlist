import{k as K,c as Z,e as nt,l as ct,a as et,g as mt,B as J,m as _t,r as bt,o as kt,n as B}from"../chunks/DT-DogFM.js";import{f as p,s as q,a as o,t as tt,b as at}from"../chunks/Du2ossJl.js";import{c as m,r as u,s as y,t as z,l as t,p as yt,q as R,k as Y,v as dt,a as xt,o as a,m as wt,f as W,n as G}from"../chunks/Cl0Xhb8i.js";import{p as vt,i as L,r as st}from"../chunks/D9aH2qsm.js";import{a as St}from"../chunks/CJwoiwRm.js";import{F as $t}from"../chunks/D67SVQWQ.js";import{S as It}from"../chunks/CgoKSQp-.js";const Pt=async({fetch:b})=>{try{return await K.ensureInitialized(b),{folderPath:K.folderPath||"",scriptActionId:K.scriptActionId||""}}catch(s){return{folderPath:"",scriptActionId:"",error:s instanceof Error?s.message:"An unknown error occurred."}}},ee=Object.freeze(Object.defineProperty({__proto__:null,load:Pt},Symbol.toStringTag,{value:"Module"}));var At=p('<a class="svelte-kzvegf"> </a>'),Dt=p('<li class="svelte-kzvegf"><!></li>'),jt=p('<ol class="svelte-kzvegf"></ol>'),Tt=p('<a class="svelte-kzvegf"> </a>'),Rt=p('<li class="svelte-kzvegf"><!></li>'),zt=p('<ul class="svelte-kzvegf"></ul>'),Ct=p('<div><h2 class="svelte-kzvegf"> </h2> <!></div>');function ut(b,s){let c=vt(s,"variant",3,"default"),l=vt(s,"listType",3,"unordered");const h={default:"instruction-box--default",success:"instruction-box--success",info:"instruction-box--info",help:"instruction-box--help"};var $=Ct(),C=m($),_=m(C,!0);u(C);var I=y(C,2);{var M=D=>{var P=jt();nt(P,21,()=>s.steps,x=>x.label,(x,k)=>{var A=Dt(),j=m(A);{var V=d=>{var i=At(),E=m(i,!0);u(i),z(()=>{ct(i,"href",`#${t(k).href}`),q(E,t(k).label)}),o(d,i)},U=d=>{var i=tt();z(()=>q(i,t(k).label)),o(d,i)};L(j,d=>{t(k).href?d(V):d(U,!1)})}u(A),o(x,A)}),u(P),o(D,P)},Q=D=>{var P=zt();nt(P,21,()=>s.steps,x=>x.label,(x,k)=>{var A=Rt(),j=m(A);{var V=d=>{var i=Tt(),E=m(i,!0);u(i),z(()=>{ct(i,"href",`#${t(k).href}`),q(E,t(k).label)}),o(d,i)},U=d=>{var i=tt();z(()=>q(i,t(k).label)),o(d,i)};L(j,d=>{t(k).href?d(V):d(U,!1)})}u(A),o(x,A)}),u(P),o(D,P)};L(I,D=>{l()==="ordered"?D(M):D(Q,!1)})}u($),z(()=>{Z($,1,`instruction-box ${h[c()]??""}`,"svelte-kzvegf"),q(_,s.title)}),o(b,$)}var Vt=at('<svg><path fill="currentColor" d="m23 12l-4-4v3h-9v2h9v3M1 18V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v3h-2V6H3v12h12v-3h2v3a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2"></path></svg>');function Et(b,s){const c=st(s,["$$slots","$$events","$$legacy"]);var l=Vt();et(l,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...c})),o(b,l)}var Ft=at('<svg><path fill="currentColor" d="m14 12l-4-4v3H2v2h8v3m10 2V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v3h2V6h12v12H6v-3H4v3a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2"></path></svg>');function Ot(b,s){const c=st(s,["$$slots","$$events","$$legacy"]);var l=Ft();et(l,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...c})),o(b,l)}var Bt=at('<svg><path fill="currentColor" d="M17.65 6.35A7.96 7.96 0 0 0 12 4a8 8 0 0 0-8 8a8 8 0 0 0 8 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18a6 6 0 0 1-6-6a6 6 0 0 1 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"></path></svg>');function qt(b,s){const c=st(s,["$$slots","$$events","$$legacy"]);var l=Bt();et(l,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...c})),o(b,l)}var Lt=p("<!> Refresh Status",1),Mt=p("<div> </div>"),Ut=p('<div class="validation-message validation-message--pending svelte-8qsi6d">Click "Save" to validate this folder path</div>'),Ht=p('<div class="form-group"><label for="backing-tracks-folder">Backing Tracks Root Folder:</label> <input type="text" id="backing-tracks-folder" name="backing-tracks-folder" placeholder="e.g., /path/to/your/backing/tracks"/> <!></div> <div class="submit-section"><!></div>',1),Nt=p("<!> Export Data",1),Jt=p("<!> Import Data",1),Wt=p('<div class="content svelte-8qsi6d"><h1>Setup</h1> <!> <div class="script-status svelte-8qsi6d"><!> <!></div> <!> <div class="import-export svelte-8qsi6d"><h3>Data Management</h3> <div class="import-export-buttons svelte-8qsi6d"><!> <!></div></div></div>');function ae(b,s){yt(s,!0);const c=mt();let l=R(Y(s.data.folderPath)),h=R(Y(s.data.scriptActionId&&s.data.scriptActionId.trim()!==""?"completed":"pending")),$=R(!1),C=R(!1),_=R("pending"),I=R(""),M=R(Y(s.data.folderPath));const Q=[{label:"Add your songs",href:"/song"},{label:"Create setlists",href:"/"}],D=[{label:'Open Reaper and go to "Actions" > "Show Action List".'},{label:"If you installed this via ReaPack, the reaper-setlist.lua script should already be listed here."},{label:'If not, click "New Action" > "Load ReaScript..." and open the reaper-setlist.lua script.'},{label:"Simply run the script to register it."},{label:"Use the refresh button below to check installation status."},{label:"Enter the root folder path where your backing tracks are stored in the form below."},{label:'Click "Save" to store these settings.'}];dt(()=>{!t(C)&&t(h)!=="completed"&&(a(C,!0),x())}),dt(()=>{t(l)!==t(M)&&t(_)!=="pending"&&(a(_,"pending"),a(I,""))});async function P(e){var g;e.preventDefault();let r=(((g=new FormData(e.target).get("backing-tracks-folder"))==null?void 0:g.toString())||"").replaceAll("\\","/");for(;r.includes("//");)r=r.replace("//","/");a(_,"checking"),a(I,"Validating folder...");try{await K.updateFolderPath(r);const f=await c.script.listProjects();f.length>0?(a(_,"success"),a(I,`Found ${f.length} project${f.length===1?"":"s"}`),B.success("Settings saved successfully!")):(a(_,"warning"),a(I,"No .rpp files found in this folder"),B.warning("Settings saved but no projects were found. Please double-check the folder path.")),a(l,r,!0),a(M,r,!0)}catch(f){a(_,"error"),a(I,`Error: ${f.message}`),B.error(`Failed to save settings: ${f.message}`);return}}async function x(){if(!t($)){a($,!0),a(h,"running");try{const e=await c.scriptSettings.getScriptActionId();if(e&&e.trim()!==""){const w=_t();await c.script.testActionId(w)===`Test action ID received: ${e}`?a(h,"completed"):a(h,"error"),a(h,"completed")}else a(h,"error")}catch(e){console.error("Error checking script installation:",e),a(h,"error")}finally{a($,!1)}}}async function k(){const e=await c.songs.list(),w=await c.sets.list(),r=JSON.stringify({songs:e,sets:w},null,2),g=new Blob([r],{type:"application/json"}),f=URL.createObjectURL(g),S=document.createElement("a");S.href=f,S.download="reaper-setlist-data.json",document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(f),B.success("Data exported successfully!")}async function A(){const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async w=>{const n=w.target;if(n.files&&n.files.length>0){const r=n.files[0];try{const g=await r.text(),f=JSON.parse(g),S=new Map;for(const F of Object.values(f.songs)){const{id:O,...H}=F,v=await c.songs.add(H);S.set(O,v.id)}for(const F of Object.values(f.sets)){const{...O}=F,H={...O,songs:F.songs.map(v=>S.get(v)||v)};await c.sets.add(H)}B.success("Data imported successfully!")}catch(g){B.error(`Failed to import data: ${g.message}`)}}},e.click()}var j=Wt(),V=y(m(j),2);{var U=e=>{ut(e,{title:"Script Installation",get steps(){return D},variant:"help",listType:"ordered"})},d=e=>{ut(e,{title:"Next steps:",get steps(){return Q},variant:"success",listType:"unordered"})};L(V,e=>{t(h)==="error"?e(U):e(d,!1)})}var i=y(V,2),E=m(i);const ft=wt(()=>t(h)==="completed"?"Script is installed and ready to use":t(h)==="running"?"Checking installation status...":"Script not detected. Please install the script in Reaper and refresh.");It(E,{title:"Script Installation Status",get description(){return t(ft)},get status(){return t(h)}});var pt=y(E,2);J(pt,{elementType:"button",onclick:x,get disabled(){return t($)},variant:"text",children:(e,w)=>{var n=Lt(),r=W(n);qt(r,{}),G(),o(e,n)},$$slots:{default:!0}}),u(i);var rt=y(i,2);$t(rt,{onsubmit:P,children:(e,w)=>{var n=Ht(),r=W(n),g=y(m(r),2);bt(g);var f=y(g,2);{var S=v=>{var T=Mt(),N=m(T,!0);u(T),z(()=>{Z(T,1,`validation-message validation-message--${t(_)??""}`,"svelte-8qsi6d"),q(N,t(I))}),o(v,T)},F=(v,T)=>{{var N=X=>{var gt=Ut();o(X,gt)};L(v,X=>{t(l)&&t(l).trim()!==""&&t(l)!==t(M)&&X(N)},T)}};L(f,v=>{t(I)?v(S):v(F,!1)})}u(r);var O=y(r,2),H=m(O);J(H,{elementType:"submit",color:"success",children:(v,T)=>{G();var N=tt("Save");o(v,N)},$$slots:{default:!0}}),u(O),z(()=>Z(g,1,kt(t(_)==="success"?"success":t(_)==="warning"?"warning":t(_)==="error"?"error":""))),St(g,()=>t(l),v=>a(l,v)),o(e,n)},$$slots:{default:!0}});var ot=y(rt,2),it=y(m(ot),2),lt=m(it);J(lt,{elementType:"button",onclick:k,variant:"text",children:(e,w)=>{var n=Nt(),r=W(n);Et(r,{}),G(),o(e,n)},$$slots:{default:!0}});var ht=y(lt,2);J(ht,{elementType:"button",onclick:A,variant:"text",children:(e,w)=>{var n=Jt(),r=W(n);Ot(r,{}),G(),o(e,n)},$$slots:{default:!0}}),u(it),u(ot),u(j),o(b,j),xt()}export{ae as component,ee as universal};
