import{b as L,a as g,d as ke,f as I,g as jt,s as h,t as be}from"../chunks/Du2ossJl.js";import{o as we,a as Te}from"../chunks/BdtkCd8H.js";import{p as Se,q as M,k as zt,s as o,f as R,a as Pe,c as r,o as $,l as t,m as _,r as s,t as rt,n as Me,a6 as Rt}from"../chunks/Cl0Xhb8i.js";import{r as B,i as V}from"../chunks/D9aH2qsm.js";import{a as D,g as Fe,n as F,B as A,e as Ae,j as Y,f as Ie}from"../chunks/DT-DogFM.js";import{P as Le}from"../chunks/Do2nJgk4.js";const st=0,at=1,Vt=2,Be=5;var De=L('<svg><path fill="currentColor" d="M14 19h4V5h-4M6 19h4V5H6z"></path></svg>');function Ce(u,c){const v=B(c,["$$slots","$$events","$$legacy"]);var a=De();D(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),g(u,a)}var Ee=L('<svg><path fill="currentColor" d="M19 12c0 3.86-3.14 7-7 7s-7-3.14-7-7s3.14-7 7-7s7 3.14 7 7"></path></svg>');function je(u,c){const v=B(c,["$$slots","$$events","$$legacy"]);var a=Ee();D(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),g(u,a)}var ze=L('<svg><path fill="currentColor" d="M16 18h2V6h-2M6 18l8.5-6L6 6z"></path></svg>');function Re(u,c){const v=B(c,["$$slots","$$events","$$legacy"]);var a=ze();D(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),g(u,a)}var Ve=L('<svg><path fill="currentColor" d="M6 18V6h2v12zm3.5-6L18 6v12z"></path></svg>');function Ye(u,c){const v=B(c,["$$slots","$$events","$$legacy"]);var a=Ve();D(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),g(u,a)}var He=L('<svg><path fill="currentColor" d="M18 18H6V6h12z"></path></svg>');function Ne(u,c){const v=B(c,["$$slots","$$events","$$legacy"]);var a=He();D(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),g(u,a)}var Ue=I('<div class="next-song svelte-tcdq5v"><div class="next-song-name svelte-tcdq5v"> </div> <div class="next-song-duration svelte-tcdq5v"> </div></div>'),Oe=I('<div class="set-complete svelte-tcdq5v">Set Complete!</div>'),Ge=(u,c)=>c(),Je=(u,c,v)=>c(t(v)),Ke=I('<button class="marker-button svelte-tcdq5v"><div class="marker-name svelte-tcdq5v"> </div> <div class="marker-time svelte-tcdq5v"> </div></button>'),Qe=I('<div class="current-song-section svelte-tcdq5v"><div class="song-info svelte-tcdq5v"><div class="song-meta svelte-tcdq5v"><span class="song-number"> </span></div> <h2 class="song-title svelte-tcdq5v"> </h2></div> <div class="track-navigation svelte-tcdq5v"><!> <!></div> <div class="next-up-info svelte-tcdq5v"><div class="next-up-header svelte-tcdq5v"><h4 class="svelte-tcdq5v">Next Up</h4> <!></div></div></div> <div class="transport-section svelte-tcdq5v"><div class="transport-controls svelte-tcdq5v"><div class="main-controls svelte-tcdq5v"><!> <!> <!></div></div> <div class="song-progress"><div class="progress-group svelte-tcdq5v"><div class="progress-label svelte-tcdq5v"><span>Song Progress</span> <span class="time-display svelte-tcdq5v"> </span></div> <div class="progress-bar-container svelte-tcdq5v"><div class="progress-bar svelte-tcdq5v"><div class="progress-fill svelte-tcdq5v"></div> <div class="progress-handle svelte-tcdq5v"></div></div></div> <div class="remaining-time svelte-tcdq5v"> </div></div></div></div> <div class="set-section svelte-tcdq5v"><div class="set-progress"><div class="progress-group svelte-tcdq5v"><div class="progress-label svelte-tcdq5v"><span>Set Progress</span> <span class="time-display svelte-tcdq5v"> </span></div> <div class="progress-bar-container svelte-tcdq5v"><div class="progress-bar set-progress-bar svelte-tcdq5v"><div class="progress-fill svelte-tcdq5v"></div> <div class="progress-handle svelte-tcdq5v"></div></div></div> <div class="remaining-time svelte-tcdq5v"> </div></div></div></div> <div class="markers-section svelte-tcdq5v"><h3 class="svelte-tcdq5v">Song Markers</h3> <div class="markers-grid svelte-tcdq5v"><button class="marker-button svelte-tcdq5v"><div class="marker-name svelte-tcdq5v">Start</div> <div class="marker-time svelte-tcdq5v"> </div></button> <!></div></div>',1),We=I('<div class="no-setlist svelte-tcdq5v"><h2 class="svelte-tcdq5v">No Setlist Loaded</h2> <p class="svelte-tcdq5v">Please load a setlist to begin playing.</p> <!></div>'),Xe=I('<meta:head><title>Player - Reaper Setlist</title></meta:head> <div class="player-container svelte-tcdq5v"><h1>Live Player</h1> <!></div>',1);function or(u,c){Se(c,!0);const v=Fe();let a=M(null),l=M(0),q=M(zt(st)),T=M(0),ot=_(()=>t(a)?t(a).slice(0,t(l)).reduce((e,i)=>e+(i.length||0),0)+t(T):0),H=M(null),N=M(null);const U=_(()=>!t(a)||t(l)<0||t(l)>=t(a).length?null:t(a)[t(l)]||null);let vt=M(zt([]));const C=_(()=>{var e;return((e=t(U))==null?void 0:e.length)||0}),Yt=_(()=>Math.max(0,t(C)-t(T))),O=_(()=>t(a)?t(a).reduce((e,i)=>e+(i.length||0),0):0),Ht=_(()=>t(a)?(()=>{let e=0;for(let i=t(l);i<t(a).length;i++){const w=t(a)[i].length||0;i===t(l)?e+=Math.max(0,w-t(T)):e+=w}return e})():0),it=_(()=>t(C)===0?0:Math.min(100,t(T)/t(C)*100)),nt=_(()=>t(O)===0?0:Math.min(100,t(ot)/t(O)*100));function k(e){const i=Math.floor(e/60),b=Math.floor(e%60);return`${i}:${b.toString().padStart(2,"0")}`}function lt(e){return e.replace(/\.[^/.]+$/,"")}async function Nt(){try{if(t(q)===at){const e=await v.reaper.pause();y(e)}else if(t(q)===Vt||t(q)===st){const e=await v.reaper.play();y(e)}}catch(e){F.error(`Failed to toggle playback: ${e.message}`)}}async function Ut(){try{const e=await v.reaper.stop();y(e)}catch(e){F.error(`Failed to stop playback: ${e.message}`)}}async function Ot(){if(t(l)>0){Rt(l,-1);const e=await v.reaper.previousTab();G(e.markers),y(e.transport)}}async function Gt(){if(t(a)&&t(l)<t(a).length-1){Rt(l);const e=await v.reaper.nextTab();G(e.markers),y(e.transport)}}async function Jt(e){try{const i=await v.reaper.goToMarker(e.id);y(i)}catch(i){F.error(`Failed to jump to marker: ${i.message}`),console.error("Failed to jump to marker:",i)}}async function Kt(){try{const e=await v.reaper.goToStart();y(e)}catch(e){F.error(`Failed to jump to song start: ${e.message}`),console.error("Failed to jump to song start:",e)}}async function Qt(){try{const e=await v.reaper.record();y(e)}catch(e){F.error(`Failed to toggle recording: ${e.message}`),console.error("Failed to toggle recording:",e)}}function y(e){e?($(q,e.playState,!0),$(T,e.positionSeconds,!0)):($(q,st,!0),$(T,0))}function G(e){$(vt,e,!0)}async function ct(){try{const e=await v.reaper.getTransport();y(e)}catch(e){console.error("Failed to update transport:",e)}}async function dt(){try{const e=await v.reaper.getMarkers();G(e)}catch(e){console.error("Failed to load markers:",e)}}async function pt(){try{const e=await v.script.getOpenTabs();(t(a)!==e.tabs||t(l)!==e.activeIndex)&&($(a,e.tabs,!0),$(l,e.activeIndex,!0),await dt()),(t(l)<0||t(l)>=t(a).length)&&$(l,0)}catch(e){console.error(`Failed to refresh tabs: ${e.message}`)}}we(async()=>{try{$(N,window.setInterval(pt,5e3),!0),$(H,window.setInterval(ct,1e3),!0),await pt(),await dt(),await ct()}catch(e){F.error(`Failed to load initial data: ${e.message}`),console.error(`Failed to load data: ${e.message}`)}}),Te(()=>{t(H)&&window.clearInterval(t(H)),t(N)&&window.clearInterval(t(N))});var gt=Xe(),ut=o(R(gt),2),Wt=o(r(ut),2);{var Xt=e=>{var i=Qe(),b=R(i),w=r(b),E=r(w),j=r(E),te=r(j);s(j),s(E);var mt=o(E,2),ee=r(mt,!0);s(mt),s(w);var J=o(w,2),_t=r(J);const re=_(()=>t(l)===0);A(_t,{variant:"icon",onclick:Ot,get disabled(){return t(re)},children:(n,d)=>{Ye(n,{})},$$slots:{default:!0}});var se=o(_t,2);const ae=_(()=>!t(a)||t(l)>=t(a).length-1);A(se,{variant:"icon",onclick:Gt,get disabled(){return t(ae)},children:(n,d)=>{Re(n,{})},$$slots:{default:!0}}),s(J);var ht=o(J,2),ft=r(ht),oe=o(r(ft),2);{var ve=n=>{var d=jt();const m=_(()=>t(a)[t(l)+1]);var x=R(d);{var S=f=>{var p=Ue(),P=r(p),$e=r(P,!0);s(P);var Et=o(P,2),qe=r(Et,!0);s(Et),s(p),rt((ye,xe)=>{h($e,ye),h(qe,xe)},[()=>lt(t(m).name),()=>Ie(t(m).length)]),g(f,p)};V(x,f=>{t(m)&&f(S)})}g(n,d)},ie=n=>{var d=Oe();g(n,d)};V(oe,n=>{t(l)<t(a).length-1?n(ve):n(ie,!1)})}s(ft),s(ht),s(b);var K=o(b,2),Q=r(K),$t=r(Q),qt=r($t);const ne=_(()=>t(q)===at||t(q)===Vt?"delete":"primary");A(qt,{variant:"icon",onclick:Ut,get color(){return t(ne)},children:(n,d)=>{Ne(n,{})},$$slots:{default:!0}});var yt=o(qt,2);A(yt,{variant:"icon",onclick:Nt,color:"success",children:(n,d)=>{var m=jt(),x=R(m);{var S=p=>{Ce(p,{})},f=p=>{Le(p,{})};V(x,p=>{t(q)===at?p(S):p(f,!1)})}g(n,m)},$$slots:{default:!0}});var le=o(yt,2);const ce=_(()=>t(q)===Be?"delete":"primary");A(le,{variant:"icon",onclick:Qt,get color(){return t(ce)},children:(n,d)=>{je(n,{})},$$slots:{default:!0}}),s($t),s(Q);var xt=o(Q,2),kt=r(xt),W=r(kt),bt=o(r(W),2),de=r(bt);s(bt),s(W);var X=o(W,2),wt=r(X),Tt=r(wt),pe=o(Tt,2);s(wt),s(X);var St=o(X,2),ge=r(St);s(St),s(kt),s(xt),s(K);var Z=o(K,2),Pt=r(Z),Mt=r(Pt),tt=r(Mt),Ft=o(r(tt),2),ue=r(Ft);s(Ft),s(tt);var et=o(tt,2),At=r(et),It=r(At),me=o(It,2);s(At),s(et);var Lt=o(et,2),_e=r(Lt);s(Lt),s(Mt),s(Pt),s(Z);var Bt=o(Z,2),Dt=o(r(Bt),2),z=r(Dt);z.__click=[Ge,Kt];var Ct=o(r(z),2),he=r(Ct,!0);s(Ct),s(z);var fe=o(z,2);Ae(fe,17,()=>t(vt),n=>n.id,(n,d)=>{var m=Ke();m.__click=[Je,Jt,d];var x=r(m),S=r(x,!0);s(x);var f=o(x,2),p=r(f,!0);s(f),s(m),rt(P=>{h(S,t(d).name),h(p,P)},[()=>k(t(d).position)]),g(n,m)}),s(Dt),s(Bt),rt((n,d,m,x,S,f,p,P)=>{h(te,`Track ${t(l)+1} of ${t(a).length??""}`),h(ee,n),h(de,`${d??""} / ${m??""}`),Y(Tt,`width: ${t(it)??""}%`),Y(pe,`left: ${t(it)??""}%`),h(ge,`-${x??""}`),h(ue,`${S??""} / ${f??""}`),Y(It,`width: ${t(nt)??""}%`),Y(me,`left: ${t(nt)??""}%`),h(_e,`-${p??""}`),h(he,P)},[()=>lt(t(U).name),()=>k(t(T)),()=>k(t(C)),()=>k(t(Yt)),()=>k(t(ot)),()=>k(t(O)),()=>k(t(Ht)),()=>k(0)]),g(e,i)},Zt=e=>{var i=We(),b=o(r(i),4);A(b,{elementType:"a",href:"#/",color:"primary",children:(w,E)=>{Me();var j=be("Browse Setlists");g(w,j)},$$slots:{default:!0}}),s(i),g(e,i)};V(Wt,e=>{t(a)&&t(U)?e(Xt):e(Zt,!1)})}s(ut),g(u,gt),Pe()}ke(["click"]);export{or as component};
