import{k as L,c as Z,e as nt,l as ct,a as et,g as mt,B as q,m as bt,r as _t,o as kt,n as W}from"../chunks/DHXfWtOE.js";import{f as p,s as B,a as o,t as tt,b as at}from"../chunks/BzJ4SX3Z.js";import{c as m,r as u,s as y,t as j,l as t,p as yt,q as R,k as Y,v as dt,a as xt,o as a,m as St,f as G,n as K}from"../chunks/CK57Ve49.js";import{p as vt,i as M,r as st}from"../chunks/_0x7LJxc.js";import{a as wt}from"../chunks/DgwUmPXI.js";import{F as $t}from"../chunks/4n-jHPVf.js";import{S as It}from"../chunks/hsiICLzS.js";const Pt=async({fetch:_})=>{try{return await L.ensureInitialized(_),{folderPath:L.folderPath||"",scriptActionId:L.scriptActionId||""}}catch(r){return{folderPath:"",scriptActionId:"",error:r instanceof Error?r.message:"An unknown error occurred."}}},ee=Object.freeze(Object.defineProperty({__proto__:null,load:Pt},Symbol.toStringTag,{value:"Module"}));var zt=p('<a class="svelte-kzvegf"> </a>'),At=p('<li class="svelte-kzvegf"><!></li>'),Dt=p('<ol class="svelte-kzvegf"></ol>'),Tt=p('<a class="svelte-kzvegf"> </a>'),Rt=p('<li class="svelte-kzvegf"><!></li>'),jt=p('<ul class="svelte-kzvegf"></ul>'),Ct=p('<div><h2 class="svelte-kzvegf"> </h2> <!></div>');function ut(_,r){let c=vt(r,"variant",3,"default"),l=vt(r,"listType",3,"unordered");const h={default:"instruction-box--default",success:"instruction-box--success",info:"instruction-box--info",help:"instruction-box--help"};var $=Ct(),C=m($),b=m(C,!0);u(C);var I=y(C,2);{var U=A=>{var P=Dt();nt(P,21,()=>r.steps,x=>x.label,(x,k)=>{var z=At(),D=m(z);{var V=d=>{var i=zt(),E=m(i,!0);u(i),j(()=>{ct(i,"href",`#${t(k).href}`),B(E,t(k).label)}),o(d,i)},H=d=>{var i=tt();j(()=>B(i,t(k).label)),o(d,i)};M(D,d=>{t(k).href?d(V):d(H,!1)})}u(z),o(x,z)}),u(P),o(A,P)},Q=A=>{var P=jt();nt(P,21,()=>r.steps,x=>x.label,(x,k)=>{var z=Rt(),D=m(z);{var V=d=>{var i=Tt(),E=m(i,!0);u(i),j(()=>{ct(i,"href",`#${t(k).href}`),B(E,t(k).label)}),o(d,i)},H=d=>{var i=tt();j(()=>B(i,t(k).label)),o(d,i)};M(D,d=>{t(k).href?d(V):d(H,!1)})}u(z),o(x,z)}),u(P),o(A,P)};M(I,A=>{l()==="ordered"?A(U):A(Q,!1)})}u($),j(()=>{Z($,1,`instruction-box ${h[c()]??""}`,"svelte-kzvegf"),B(b,r.title)}),o(_,$)}var Vt=at('<svg><path fill="currentColor" d="m23 12l-4-4v3h-9v2h9v3M1 18V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v3h-2V6H3v12h12v-3h2v3a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2"></path></svg>');function Et(_,r){const c=st(r,["$$slots","$$events","$$legacy"]);var l=Vt();et(l,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...c})),o(_,l)}var Ft=at('<svg><path fill="currentColor" d="m14 12l-4-4v3H2v2h8v3m10 2V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v3h2V6h12v12H6v-3H4v3a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2"></path></svg>');function Ot(_,r){const c=st(r,["$$slots","$$events","$$legacy"]);var l=Ft();et(l,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...c})),o(_,l)}var Bt=at('<svg><path fill="currentColor" d="M17.65 6.35A7.96 7.96 0 0 0 12 4a8 8 0 0 0-8 8a8 8 0 0 0 8 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18a6 6 0 0 1-6-6a6 6 0 0 1 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"></path></svg>');function Lt(_,r){const c=st(r,["$$slots","$$events","$$legacy"]);var l=Bt();et(l,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...c})),o(_,l)}var Mt=p("<!> Refresh Status",1),Ut=p("<div> </div>"),Ht=p('<div class="validation-message validation-message--pending svelte-sz3hb4">Click "Save" to validate this folder path</div>'),Nt=p('<div class="form-group"><label for="backing-tracks-folder">Backing Tracks Root Folder:</label> <input type="text" id="backing-tracks-folder" name="backing-tracks-folder" placeholder="e.g., /path/to/your/backing/tracks"/> <!></div> <div class="submit-section"><!></div>',1),Jt=p("<!> Export Data",1),Wt=p("<!> Import Data",1),qt=p('<div class="content svelte-sz3hb4"><h1>Setup</h1> <!> <div class="script-status svelte-sz3hb4"><!> <!></div> <!> <div class="import-export svelte-sz3hb4"><h3>Data Management</h3> <div class="import-export-buttons svelte-sz3hb4"><!> <!></div></div></div>');function ae(_,r){yt(r,!0);const c=mt();let l=R(Y(r.data.folderPath)),h=R(Y(r.data.scriptActionId&&r.data.scriptActionId.trim()!==""?"completed":"pending")),$=R(!1),C=R(!1),b=R("pending"),I=R(""),U=R(Y(r.data.folderPath));const Q=[{label:"Add your songs",href:"/song"},{label:"Create setlists",href:"/"}],A=[{label:'Open Reaper and go to "Actions" > "Show Action List".'},{label:"If you installed this via ReaPack, the reaper-setlist.lua script should already be listed here."},{label:'If not, click "New Action" > "Load ReaScript..." and open the reaper-setlist.lua script.'},{label:"Simply run the script to register it."},{label:"Use the refresh button below to check installation status."},{label:"Enter the root folder path where your backing tracks are stored in the form below."},{label:'Click "Save" to store these settings.'}];dt(()=>{!t(C)&&t(h)!=="completed"&&(a(C,!0),x())}),dt(()=>{t(l)!==t(U)&&t(b)!=="pending"&&(a(b,"pending"),a(I,""))});async function P(e){var g;e.preventDefault();let s=(((g=new FormData(e.target).get("backing-tracks-folder"))==null?void 0:g.toString())||"").replaceAll("\\","/");for(;s.includes("//");)s=s.replace("//","/");a(b,"checking"),a(I,"Validating folder..."),a(l,s,!0),a(U,s,!0);try{const f=await c.script.testProjectsFolder(s);if(!f.valid){a(b,"error"),a(I,f.message||"Invalid folder path. Please check the path and try again.",!0);return}await L.updateFolderPath(s),a(b,"success"),a(I,f.message||"Folder path is valid!",!0),W.success("Settings saved successfully!")}catch(f){a(b,"error"),a(I,`Error: ${f.message}`),W.error(`Failed to save settings: ${f.message}`);return}}async function x(){if(!t($)){a($,!0),a(h,"running");try{const e=await c.scriptSettings.getScriptActionId();if(e&&e.trim()!==""){L.reset(),await L.initialize(fetch);const S=bt();await c.script.testActionId(S)===`Test action ID received: ${e}`?a(h,"completed"):a(h,"error"),a(h,"completed")}else a(h,"error")}catch(e){console.error("Error checking script installation:",e),a(h,"error")}finally{a($,!1)}}}async function k(){const e=await c.songs.list(),S=await c.sets.list(),s=JSON.stringify({songs:e,sets:S},null,2),g=new Blob([s],{type:"application/json"}),f=URL.createObjectURL(g),w=document.createElement("a");w.href=f,w.download="reaper-setlist-data.json",document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(f),W.success("Data exported successfully!")}async function z(){const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async S=>{const n=S.target;if(n.files&&n.files.length>0){const s=n.files[0];try{const g=await s.text(),f=JSON.parse(g),w=new Map;for(const F of Object.values(f.songs)){const{id:O,...N}=F,v=await c.songs.add(N);w.set(O,v.id)}for(const F of Object.values(f.sets)){const{...O}=F,N={...O,songs:F.songs.map(v=>w.get(v)||v)};await c.sets.add(N)}W.success("Data imported successfully!")}catch(g){W.error(`Failed to import data: ${g.message}`)}}},e.click()}var D=qt(),V=y(m(D),2);{var H=e=>{ut(e,{title:"Script Installation",get steps(){return A},variant:"help",listType:"ordered"})},d=e=>{ut(e,{title:"Next steps:",get steps(){return Q},variant:"success",listType:"unordered"})};M(V,e=>{t(h)==="error"?e(H):e(d,!1)})}var i=y(V,2),E=m(i);const ft=St(()=>t(h)==="completed"?"Script is installed and ready to use":t(h)==="running"?"Checking installation status...":"Script not detected. Please install the script in Reaper and refresh.");It(E,{title:"Script Installation Status",get description(){return t(ft)},get status(){return t(h)}});var pt=y(E,2);q(pt,{elementType:"button",onclick:x,get disabled(){return t($)},variant:"text",children:(e,S)=>{var n=Mt(),s=G(n);Lt(s,{}),K(),o(e,n)},$$slots:{default:!0}}),u(i);var rt=y(i,2);$t(rt,{onsubmit:P,children:(e,S)=>{var n=Nt(),s=G(n),g=y(m(s),2);_t(g);var f=y(g,2);{var w=v=>{var T=Ut(),J=m(T,!0);u(T),j(()=>{Z(T,1,`validation-message validation-message--${t(b)??""}`,"svelte-sz3hb4"),B(J,t(I))}),o(v,T)},F=(v,T)=>{{var J=X=>{var gt=Ht();o(X,gt)};M(v,X=>{t(l)&&t(l).trim()!==""&&t(l)!==t(U)&&X(J)},T)}};M(f,v=>{t(I)?v(w):v(F,!1)})}u(s);var O=y(s,2),N=m(O);q(N,{elementType:"submit",color:"success",children:(v,T)=>{K();var J=tt("Save");o(v,J)},$$slots:{default:!0}}),u(O),j(()=>Z(g,1,kt(t(b)==="success"?"success":t(b)==="warning"?"warning":t(b)==="error"?"error":""))),wt(g,()=>t(l),v=>a(l,v)),o(e,n)},$$slots:{default:!0}});var ot=y(rt,2),it=y(m(ot),2),lt=m(it);q(lt,{elementType:"button",onclick:k,variant:"text",children:(e,S)=>{var n=Jt(),s=G(n);Et(s,{}),K(),o(e,n)},$$slots:{default:!0}});var ht=y(lt,2);q(ht,{elementType:"button",onclick:z,variant:"text",children:(e,S)=>{var n=Wt(),s=G(n);Ot(s,{}),K(),o(e,n)},$$slots:{default:!0}}),u(it),u(ot),u(D),o(_,D),xt()}export{ae as component,ee as universal};
