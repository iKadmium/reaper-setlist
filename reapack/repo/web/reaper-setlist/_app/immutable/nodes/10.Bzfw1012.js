import{b as B,a as p,d as _e,f as S,g as Bt,s as f,t as he}from"../chunks/Cyv9BU93.js";import{o as fe,a as $e}from"../chunks/D5RknIJE.js";import{p as qe,q as P,k as Dt,s as o,f as N,a as ye,c as r,o as b,l as t,m as u,r as s,t as ot,n as xe,a6 as Ct}from"../chunks/CXoDX78y.js";import{r as D,i as L}from"../chunks/CshSjHoe.js";import{a as C,g as ke,B as M,m as H,n as O,e as we,i as Te,f as be}from"../chunks/BaaqWfM4.js";import{P as Se}from"../chunks/Camoe4SX.js";const vt=0,it=1,Et=2,Pe=5;var Me=B('<svg><path fill="currentColor" d="M14 19h4V5h-4M6 19h4V5H6z"></path></svg>');function Ae(m,g){const v=D(g,["$$slots","$$events","$$legacy"]);var a=Me();C(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),p(m,a)}var Fe=B('<svg><path fill="currentColor" d="M19 12c0 3.86-3.14 7-7 7s-7-3.14-7-7s3.14-7 7-7s7 3.14 7 7"></path></svg>');function Le(m,g){const v=D(g,["$$slots","$$events","$$legacy"]);var a=Fe();C(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),p(m,a)}var Be=B('<svg><path fill="currentColor" d="M16 18h2V6h-2M6 18l8.5-6L6 6z"></path></svg>');function De(m,g){const v=D(g,["$$slots","$$events","$$legacy"]);var a=Be();C(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),p(m,a)}var Ce=B('<svg><path fill="currentColor" d="M6 18V6h2v12zm3.5-6L18 6v12z"></path></svg>');function Ee(m,g){const v=D(g,["$$slots","$$events","$$legacy"]);var a=Ce();C(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),p(m,a)}var ze=B('<svg><path fill="currentColor" d="M18 18H6V6h12z"></path></svg>');function Ie(m,g){const v=D(g,["$$slots","$$events","$$legacy"]);var a=ze();C(a,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...v})),p(m,a)}var Re=S('<div class="next-song svelte-tcdq5v"><div class="next-song-name svelte-tcdq5v"> </div> <div class="next-song-duration svelte-tcdq5v"> </div></div>'),Ve=S('<div class="set-complete svelte-tcdq5v">Set Complete!</div>'),Ye=(m,g,v)=>g(t(v)),Ne=S('<button class="marker-button svelte-tcdq5v"><div class="marker-name svelte-tcdq5v"> </div> <div class="marker-time svelte-tcdq5v"> </div></button>'),He=S('<div class="markers-section svelte-tcdq5v"><h3 class="svelte-tcdq5v">Song Markers</h3> <div class="markers-grid svelte-tcdq5v"></div></div>'),Oe=S('<div class="current-song-section svelte-tcdq5v"><div class="song-info svelte-tcdq5v"><div class="song-meta svelte-tcdq5v"><span class="song-number"> </span></div> <h2 class="song-title svelte-tcdq5v"> </h2></div> <div class="track-navigation svelte-tcdq5v"><!> <!></div> <div class="next-up-info svelte-tcdq5v"><div class="next-up-header svelte-tcdq5v"><h4 class="svelte-tcdq5v">Next Up</h4> <!></div></div></div> <div class="transport-section svelte-tcdq5v"><div class="transport-controls svelte-tcdq5v"><div class="main-controls svelte-tcdq5v"><!> <!> <!></div></div> <div class="song-progress"><div class="progress-group svelte-tcdq5v"><div class="progress-label svelte-tcdq5v"><span>Song Progress</span> <span class="time-display svelte-tcdq5v"> </span></div> <div class="progress-bar-container svelte-tcdq5v"><div class="progress-bar svelte-tcdq5v"><div class="progress-fill svelte-tcdq5v"></div> <div class="progress-handle svelte-tcdq5v"></div></div></div> <div class="remaining-time svelte-tcdq5v"> </div></div></div></div> <div class="set-section svelte-tcdq5v"><div class="set-progress"><div class="progress-group svelte-tcdq5v"><div class="progress-label svelte-tcdq5v"><span>Set Progress</span> <span class="time-display svelte-tcdq5v"> </span></div> <div class="progress-bar-container svelte-tcdq5v"><div class="progress-bar set-progress-bar svelte-tcdq5v"><div class="progress-fill svelte-tcdq5v"></div> <div class="progress-handle svelte-tcdq5v"></div></div></div> <div class="remaining-time svelte-tcdq5v"> </div></div></div></div> <!>',1),Ue=S('<div class="no-setlist svelte-tcdq5v"><h2 class="svelte-tcdq5v">No Setlist Loaded</h2> <p class="svelte-tcdq5v">Please load a setlist to begin playing.</p> <!></div>'),je=S('<meta:head><title>Player - Reaper Setlist</title></meta:head> <div class="player-container svelte-tcdq5v"><h1>Live Player</h1> <!></div>',1);function Ze(m,g){qe(g,!0);const v=ke();let a=P(null),c=P(0),$=P(Dt(vt)),k=P(0),nt=u(()=>t(a)?t(a).slice(0,t(c)).reduce((e,n)=>e+(n.length||0),0)+t(k):0),U=P(null);const j=u(()=>!t(a)||t(c)<0||t(c)>=t(a).length?null:t(a)[t(c)]||null);let G=P(Dt([]));const E=u(()=>{var e;return((e=t(j))==null?void 0:e.length)||0}),zt=u(()=>Math.max(0,t(E)-t(k))),J=u(()=>t(a)?t(a).reduce((e,n)=>e+(n.length||0),0):0),It=u(()=>t(a)?(()=>{let e=0;for(let n=t(c);n<t(a).length;n++){const x=t(a)[n].length||0;n===t(c)?e+=Math.max(0,x-t(k)):e+=x}return e})():0),lt=u(()=>t(E)===0?0:Math.min(100,t(k)/t(E)*100)),ct=u(()=>t(J)===0?0:Math.min(100,t(nt)/t(J)*100));function w(e){const n=Math.floor(e/60),y=Math.floor(e%60);return`${n}:${y.toString().padStart(2,"0")}`}function dt(e){return e.replace(/\.[^/.]+$/,"")}async function Rt(){try{if(t($)===it){const e=await v.reaper.pause();A(e)}else if(t($)===Et||t($)===vt){const e=await v.reaper.play();A(e)}}catch(e){O.error(`Failed to toggle playback: ${e.message}`)}}async function Vt(){try{await v.reaper.stop(),await z()}catch(e){O.error(`Failed to stop playback: ${e.message}`)}}async function Yt(){if(t(c)>0){Ct(c,-1);const e=await v.reaper.previousTab();K(e.markers),A(e.transport)}}async function Nt(){if(t(a)&&t(c)<t(a).length-1){Ct(c);const e=await v.reaper.nextTab();K(e.markers),A(e.transport)}}async function Ht(e){try{await v.reaper.goToMarker(e.id),await z()}catch(n){O.error(`Failed to jump to marker: ${n.message}`),console.error("Failed to jump to marker:",n)}}async function Ot(){try{await v.reaper.record(),await z()}catch(e){O.error(`Failed to toggle recording: ${e.message}`),console.error("Failed to toggle recording:",e)}}function A(e){e?(b($,e.playState,!0),b(k,e.positionSeconds,!0)):(b($,vt,!0),b(k,0))}function K(e){b(G,e,!0)}async function z(){try{const e=await v.reaper.getTransport();A(e)}catch(e){console.error("Failed to update transport:",e)}}async function Ut(){try{const e=await v.reaper.getMarkers();K(e)}catch(e){console.error("Failed to load markers:",e)}}fe(async()=>{try{b(a,await v.script.getOpenTabs(),!0),b(U,window.setInterval(z,1e3),!0),await Ut()}catch(e){console.error(`Failed to load data: ${e.message}`)}}),$e(()=>{t(U)&&window.clearInterval(t(U))});var pt=je(),gt=o(N(pt),2),jt=o(r(gt),2);{var Gt=e=>{var n=Oe(),y=N(n),x=r(y),I=r(x),R=r(I),Kt=r(R);s(R),s(I);var ut=o(I,2),Qt=r(ut,!0);s(ut),s(x);var Q=o(x,2),mt=r(Q);const Wt=u(()=>t(c)===0);M(mt,{variant:"icon",onclick:Yt,get disabled(){return t(Wt)},children:(i,d)=>{Ee(i,{})},$$slots:{default:!0}});var Xt=o(mt,2);const Zt=u(()=>!t(a)||t(c)>=t(a).length-1);M(Xt,{variant:"icon",onclick:Nt,get disabled(){return t(Zt)},children:(i,d)=>{De(i,{})},$$slots:{default:!0}}),s(Q);var _t=o(Q,2),ht=r(_t),te=o(r(ht),2);{var ee=i=>{var d=Bt();const h=u(()=>t(a)[t(c)+1]);var T=N(d);{var q=_=>{var l=Re(),F=r(l),V=r(F,!0);s(F);var Y=o(F,2),at=r(Y,!0);s(Y),s(l),ot((ue,me)=>{f(V,ue),f(at,me)},[()=>dt(t(h).name),()=>be(t(h).length)]),p(_,l)};L(T,_=>{t(h)&&_(q)})}p(i,d)},se=i=>{var d=Ve();p(i,d)};L(te,i=>{t(c)<t(a).length-1?i(ee):i(se,!1)})}s(ht),s(_t),s(y);var W=o(y,2),X=r(W),ft=r(X),$t=r(ft);const re=u(()=>t($)===it||t($)===Et?"delete":"primary");M($t,{variant:"icon",onclick:Vt,get color(){return t(re)},children:(i,d)=>{Ie(i,{})},$$slots:{default:!0}});var qt=o($t,2);M(qt,{variant:"icon",onclick:Rt,color:"success",children:(i,d)=>{var h=Bt(),T=N(h);{var q=l=>{Ae(l,{})},_=l=>{Se(l,{})};L(T,l=>{t($)===it?l(q):l(_,!1)})}p(i,h)},$$slots:{default:!0}});var ae=o(qt,2);const oe=u(()=>t($)===Pe?"delete":"primary");M(ae,{variant:"icon",onclick:Ot,get color(){return t(oe)},children:(i,d)=>{Le(i,{})},$$slots:{default:!0}}),s(ft),s(X);var yt=o(X,2),xt=r(yt),Z=r(xt),kt=o(r(Z),2),ve=r(kt);s(kt),s(Z);var tt=o(Z,2),wt=r(tt),Tt=r(wt),ie=o(Tt,2);s(wt),s(tt);var bt=o(tt,2),ne=r(bt);s(bt),s(xt),s(yt),s(W);var et=o(W,2),St=r(et),Pt=r(St),st=r(Pt),Mt=o(r(st),2),le=r(Mt);s(Mt),s(st);var rt=o(st,2),At=r(rt),Ft=r(At),ce=o(Ft,2);s(At),s(rt);var Lt=o(rt,2),de=r(Lt);s(Lt),s(Pt),s(St),s(et);var pe=o(et,2);{var ge=i=>{var d=He(),h=o(r(d),2);we(h,21,()=>t(G),Te,(T,q)=>{var _=Ne();_.__click=[Ye,Ht,q];var l=r(_),F=r(l,!0);s(l);var V=o(l,2),Y=r(V,!0);s(V),s(_),ot(at=>{f(F,t(q).name),f(Y,at)},[()=>w(t(q).position)]),p(T,_)}),s(h),s(d),p(i,d)};L(pe,i=>{t(G).length>0&&i(ge)})}ot((i,d,h,T,q,_,l)=>{f(Kt,`Track ${t(c)+1} of ${t(a).length??""}`),f(Qt,i),f(ve,`${d??""} / ${h??""}`),H(Tt,`width: ${t(lt)??""}%`),H(ie,`left: ${t(lt)??""}%`),f(ne,`-${T??""}`),f(le,`${q??""} / ${_??""}`),H(Ft,`width: ${t(ct)??""}%`),H(ce,`left: ${t(ct)??""}%`),f(de,`-${l??""}`)},[()=>dt(t(j).name),()=>w(t(k)),()=>w(t(E)),()=>w(t(zt)),()=>w(t(nt)),()=>w(t(J)),()=>w(t(It))]),p(e,n)},Jt=e=>{var n=Ue(),y=o(r(n),4);M(y,{elementType:"a",href:"/",color:"primary",children:(x,I)=>{xe();var R=he("Browse Setlists");p(x,R)},$$slots:{default:!0}}),s(n),p(e,n)};L(jt,e=>{t(a)&&t(j)?e(Gt):e(Jt,!1)})}s(gt),p(m,pt),ye()}_e(["click"]);export{Ze as component};
