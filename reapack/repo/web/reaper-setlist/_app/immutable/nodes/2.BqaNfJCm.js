import{g as z,a as N,B as b,n as x,f as Q}from"../chunks/R0BlLbBX.js";import{b as W,a as g,f as C,t as X,s as D}from"../chunks/CS4_VdcA.js";import{o as Z}from"../chunks/DUA-E5SE.js";import{p as ee,k as te,s as u,f as O,a as se,c as o,n as ae,r as n,t as R,x as V,l as F,m as T}from"../chunks/Sw90J2G4.js";import{r as re,i as oe}from"../chunks/Czi9triy.js";import{I as ne,R as ie,P as ce}from"../chunks/Dgt82f7Z.js";import{D as le}from"../chunks/2bHrKCxW.js";import{P as de}from"../chunks/CATmRVNY.js";const ue=async({fetch:_})=>{try{const s=z(_),[i,v]=await Promise.all([s.sets.list(),s.songs.list()]);return{sets:i,songs:v}}catch(s){return console.error("Error loading sets and songs:",s),{sets:{},songs:{},error:s instanceof Error?s.message:"An unknown error occurred."}}},Se=Object.freeze(Object.defineProperty({__proto__:null,load:ue},Symbol.toStringTag,{value:"Module"}));var ve=W('<svg><path fill="currentColor" d="M19 21H8V7h11m0-2H8a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2m-3-4H4a2 2 0 0 0-2 2v14h2V3h12z"></path></svg>');function pe(_,s){const i=re(s,["$$slots","$$events","$$legacy"]);var v=ve();N(v,()=>({viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...i})),g(_,v)}var fe=C('<p style="color: red;"> </p>'),me=C('<div class="set-info svelte-1sbbukk"><div class="set-header svelte-1sbbukk"><span class="date svelte-1sbbukk"> </span> <span class="venue svelte-1sbbukk"> </span></div> <div class="set-details svelte-1sbbukk"><span class="song-count svelte-1sbbukk"> </span> <span class="duration svelte-1sbbukk"> </span></div></div>'),ge=C("<!> <!> <!>",1),_e=C('<meta:head><title>Sets - Reaper Setlist</title></meta:head> <h1>Sets</h1> <!> <div class="action-section"><!></div>',1);function Ae(_,s){ee(s,!0);const i=te(s.data.sets),v=s.data.songs,w=s.data.error,M=z();Z(()=>{w&&x.error(`Failed to load data: ${w}`)});async function E(e){if(confirm("Are you sure you want to delete this set?"))try{await M.sets.delete(e.id),delete i[e.id],x.success("Set deleted successfully")}catch(t){x.error(`Failed to delete set: ${t.message}`)}}async function I(e){const t={...e,id:void 0,venue:`${e.venue} (copy)`};try{const r=await M.sets.add(t);i[r.id]=r,x.success("Set duplicated successfully")}catch(r){x.error(`Failed to duplicate set: ${r.message}`)}}function L(e,t){return e.date!==t.date?new Date(e.date).getTime()-new Date(t.date).getTime():e.venue!==t.venue?e.venue.localeCompare(t.venue):e.id.localeCompare(t.id)}function G(e){const t=new Date(e),r=new Date().getFullYear(),H=t.getFullYear(),p={day:"numeric",month:"long"};H!==r&&(p.year="numeric");const a=navigator.language||"en-US";return t.toLocaleDateString(a,p)}var Y=_e(),j=u(O(Y),4);{var U=e=>{var t=fe(),r=o(t,!0);n(t),R(()=>D(r,w)),g(e,t)},q=e=>{const t=T(()=>Object.values(i).toSorted(L));ne(e,{get items(){return F(t)},nameDisplay:(p,a=V)=>{var S=me(),A=o(S),c=o(A),f=o(c,!0);n(c);var l=u(c,2),P=o(l,!0);n(l),n(A);var h=u(A,2),y=o(h),d=o(y);n(y);var $=u(y,2),K=o($,!0);n($),n(h),n(S),R((k,m)=>{D(f,k),D(P,a().venue),D(d,`${a().songs.length??""} song${a().songs.length>1?"s":""}`),D(K,m)},[()=>G(a().date),()=>Q(a().songs.map(k=>{var m;return((m=v[k])==null?void 0:m.length)||0}).reduce((k,m)=>k+m,0))]),g(p,S)},actions:(p,a=V)=>{ie(p,{primaryAction:c=>{const f=T(()=>`#/set/${a().id}/load`);b(c,{color:"primary",elementType:"a",get href(){return F(f)},variant:"icon",children:(l,P)=>{de(l,{})},$$slots:{default:!0}})},secondaryActions:c=>{var f=ge(),l=O(f);const P=T(()=>`#/set/${a().id}/edit`);b(l,{elementType:"a",color:"edit",get href(){return F(P)},variant:"icon",children:(d,$)=>{ce(d,{})},$$slots:{default:!0}});var h=u(l,2);b(h,{color:"delete",onclick:()=>E(a()),variant:"icon",children:(d,$)=>{le(d,{})},$$slots:{default:!0}});var y=u(h,2);b(y,{color:"success",onclick:()=>I(a()),variant:"icon",children:(d,$)=>{pe(d,{})},$$slots:{default:!0}}),g(c,f)},$$slots:{primaryAction:!0,secondaryActions:!0}})},$$slots:{nameDisplay:!0,actions:!0}})};oe(j,e=>{w?e(U):e(q,!1)})}var B=u(j,2),J=o(B);b(J,{elementType:"a",href:"#/set/add",color:"success",children:(e,t)=>{ae();var r=X("Add Set");g(e,r)},$$slots:{default:!0}}),n(B),g(_,Y),se()}export{Ae as component,Se as universal};
